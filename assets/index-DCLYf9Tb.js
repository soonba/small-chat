import{c as b,G as w,g as E,f as S,C as N,n as L,e as I,k as P,r as i,l as n,T as u,B as h,E as R}from"./index-D4QRjxp_.js";const m=/^[ㄱ-ㅎ가-힣a-zA-Z0-9]+$/,x=/^(?=.*[a-zA-Z])(?=.*[0-9]).{6,20}$/,g=/^(?=.*[a-zA-Z])(?=.*[0-9])(?=.*[!@#$%^&*?_]).{8,16}$/,_=async({accountId:e})=>E(`/v2/users/${e}/exists`).then(t=>t.data).then(t=>({data:{isUsed:t.isUsed},message:t.isUsed?"사용중인 아이디입니다.":"사용 가능한 아이디입니다.",status:200})),A=e=>b({enabled:x.test(e),queryFn:({queryKey:r})=>_({accountId:r[1]}),queryKey:w.existingId(e),select:r=>r.data.isUsed}),M=async e=>N("/v2/users",e).then(t=>t.data),U=({onError:e,onSuccess:t})=>S({mutationFn:M,onError:s=>{e&&e(s)},onSuccess:s=>{t&&t(s)}});function D(){const e=L(),{onSocketConnect:t}=I(),{onToast:r}=P(),[s,p]=i.useState(""),[l,f]=i.useState(""),[o,y]=i.useState(""),[c,j]=i.useState(""),{data:d}=A(s),k=U({onError(a){r(a.message,{delay:5e3})},onSuccess({tokens:a}){R(a),t(),e("/",{replace:!0})}}),C=a=>{a.preventDefault(),k.mutate({id:s,nickname:l,password:o})},T=()=>{e("/login")},v=i.useMemo(()=>{let a=!0;return m.test(l)||(a=!1),(!x.test(s)||d)&&(a=!1),g.test(o)||(a=!1),o!==c&&(a=!1),a},[s,o,c,l,d]);return n.jsx("div",{className:"mt-10 flex w-full items-start justify-center",children:n.jsxs("form",{className:"flex w-full max-w-screen-md flex-col gap-5 px-5",onSubmit:C,children:[n.jsx("h1",{className:"mb-5 text-center font-jua text-36-R-40 text-primary-900 dark:text-primary-100",children:"회원가입"}),n.jsx(u,{labelText:"Nickname",maxLength:20,minLength:3,placeholder:"닉네임을 입력해 주세요.",type:"text",value:l,onChange:f,helperText:l.length<3?"최소 3자, 최대 20자까지 입력해 주세요.":m.test(l)?"":"영문과 숫자 조합으로 입력해 주세요."}),n.jsx(u,{labelText:"Id",maxLength:20,minLength:6,placeholder:"아이디를 입력해 주세요.",type:"text",value:s,onChange:p,helperText:d?"중복된 아이디입니다. 다른 아이디를 입력해 주세요.":s.length<6?"최소 6자, 최대 20자까지 입력할 수 있습니다.":x.test(s)?"":"영문과 숫자 조합으로 입력해 주세요."}),n.jsx(u,{labelText:"Password",maxLength:16,minLength:8,placeholder:"비밀번호를 입력해 주세요.",type:"password",value:o,onChange:y,helperText:o.length<8?"최소 8자, 최대 16자까지 입력할 수 있습니다.":g.test(o)?"":"영문, 숫자, 특수문자 조합으로 입력해 주세요."}),n.jsx(u,{labelText:"Password Check",maxLength:16,minLength:8,placeholder:"비밀번호 확인을 입력해 주세요.",type:"password",value:c,onChange:j,helperText:c?o!==c?"비밀번호와 일치하지 않습니다.":"":"비밀번호 확인을 입력해 주세요."}),n.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[n.jsx(h,{disabled:!v,size:"large",text:"회원가입",type:"submit",variant:"contained"}),n.jsx(h,{size:"large",text:"로그인",type:"button",variant:"outlined",onClick:T})]})]})})}export{D as default};
